<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>í•€í…Œí¬ DataOps í¬íŠ¸í´ë¦¬ì˜¤ â€” QuickPay</title>
<meta name="description" content="QuickPay ê°„í¸ê²°ì œ ì„œë¹„ìŠ¤ë¥¼ ìœ„í•œ DataOps í¬íŠ¸í´ë¦¬ì˜¤. ë¡œê·¸ ì„¤ê³„, ì§€í‘œ ì •ì˜, ë°ì´í„° í’ˆì§ˆ, ì‹œê°í™”, ìš´ì˜ ìë™í™”.">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/sql.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/python.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/json.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0"></script>
<style>
/* â•â•â•â•â•â•â•â•â•â•â• Reset & Base â•â•â•â•â•â•â•â•â•â•â• */
*,*::before,*::after{margin:0;padding:0;box-sizing:border-box}
:root{
  --bg:#09090B;--bg2:#18181B;--bg3:#27272A;--border:#3F3F46;
  --text:#FAFAFA;--text2:#A1A1AA;--text3:#71717A;
  --blue:#3B82F6;--blue-bg:#3B82F620;--purple:#8B5CF6;--purple-bg:#8B5CF620;
  --green:#22C55E;--green-bg:#22C55E18;--yellow:#F59E0B;--yellow-bg:#F59E0B18;
  --red:#EF4444;--pink:#EC4899;
  --radius:12px;--radius-sm:8px;
}
html{scroll-behavior:smooth;scroll-padding-top:80px}
body{font-family:'Inter',system-ui,-apple-system,sans-serif;background:var(--bg);color:var(--text);line-height:1.7;font-size:15px;-webkit-font-smoothing:antialiased}
::selection{background:var(--blue);color:#fff}

/* â•â•â•â•â•â•â•â•â•â•â• Navigation â•â•â•â•â•â•â•â•â•â•â• */
.nav{position:fixed;top:0;left:0;right:0;z-index:100;background:var(--bg)ee;backdrop-filter:blur(20px);border-bottom:1px solid var(--border)}
.nav-inner{max-width:1200px;margin:0 auto;display:flex;align-items:center;justify-content:space-between;padding:0 32px;height:64px}
.nav-logo{font-weight:800;font-size:18px;color:var(--text);text-decoration:none}
.nav-logo span{color:var(--blue)}
.nav-links{display:flex;gap:4px;list-style:none}
.nav-links a{color:var(--text2);text-decoration:none;font-size:13px;font-weight:500;padding:6px 14px;border-radius:6px;transition:.2s}
.nav-links a:hover,.nav-links a.active{color:var(--text);background:var(--bg3)}
.nav-cta{background:var(--blue);color:#fff;font-size:13px;font-weight:600;padding:8px 20px;border-radius:8px;text-decoration:none;transition:.2s}
.nav-cta:hover{opacity:.85}

/* â•â•â•â•â•â•â•â•â•â•â• Hero â•â•â•â•â•â•â•â•â•â•â• */
.hero{padding:110px 32px 48px;text-align:center;position:relative;overflow:hidden}
.hero::before{content:'';position:absolute;top:0;left:50%;transform:translateX(-50%);width:800px;height:500px;background:radial-gradient(ellipse,var(--blue)12 0%,transparent 70%);pointer-events:none}
.hero-badge{display:inline-flex;align-items:center;gap:8px;background:var(--bg2);border:1px solid var(--border);padding:6px 16px;border-radius:20px;font-size:13px;color:var(--text2);margin-bottom:24px}
.hero-badge .dot{width:8px;height:8px;border-radius:50%;background:var(--green);animation:pulse 2s infinite}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.4}}
.hero h1{font-size:clamp(32px,5vw,56px);font-weight:800;line-height:1.15;margin-bottom:16px;letter-spacing:-1px}
.hero h1 .accent{background:linear-gradient(135deg,var(--blue),var(--purple));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.hero-sub{font-size:18px;color:var(--text2);max-width:640px;margin:0 auto 40px;line-height:1.6}
.hero-stats{display:flex;justify-content:center;gap:48px;flex-wrap:wrap}
.hero-stat .num{font-size:32px;font-weight:800;color:var(--blue)}
.hero-stat .label{font-size:12px;color:var(--text3);text-transform:uppercase;letter-spacing:.5px;margin-top:2px}

/* â•â•â•â•â•â•â•â•â•â•â• Sections â•â•â•â•â•â•â•â•â•â•â• */
.section{max-width:1200px;margin:0 auto;padding:52px 32px}
.section-header{text-align:center;margin-bottom:32px}
.section-label{display:inline-flex;align-items:center;gap:6px;font-size:12px;font-weight:700;text-transform:uppercase;letter-spacing:1.5px;color:var(--blue);margin-bottom:12px}
.section-title{font-size:clamp(24px,3.5vw,36px);font-weight:800;letter-spacing:-.5px;margin-bottom:12px}
.section-desc{font-size:16px;color:var(--text2);max-width:600px;margin:0 auto}
.divider{border:none;border-top:1px solid var(--border);margin:0 auto;max-width:1200px}

/* â•â•â•â•â•â•â•â•â•â•â• Cards â•â•â•â•â•â•â•â•â•â•â• */
.card{background:var(--bg2);border:1px solid var(--border);border-radius:var(--radius);padding:32px;transition:.3s}
.card:hover{border-color:var(--text3)}
.card-grid{display:grid;gap:20px}
.card-grid.cols-2{grid-template-columns:repeat(auto-fit,minmax(360px,1fr))}
.card-grid.cols-3{grid-template-columns:repeat(auto-fit,minmax(300px,1fr))}
.card-grid.cols-5{grid-template-columns:repeat(auto-fit,minmax(180px,1fr))}
.card-icon{width:44px;height:44px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:20px;margin-bottom:16px}
.card h3{font-size:17px;font-weight:700;margin-bottom:8px}
.card p{font-size:14px;color:var(--text2);line-height:1.6}

/* â•â•â•â•â•â•â•â•â•â•â• JD Map â•â•â•â•â•â•â•â•â•â•â• */
.jd-map{display:grid;gap:2px;border-radius:var(--radius);overflow:hidden;margin-top:40px}
.jd-row{display:grid;grid-template-columns:1fr 40px 1fr;align-items:center;background:var(--bg2);padding:18px 24px}
.jd-row:nth-child(even){background:var(--bg3)40}
.jd-left{font-size:14px;color:var(--text2)}
.jd-arrow{text-align:center;color:var(--blue);font-weight:700}
.jd-right{font-size:14px;font-weight:600;color:var(--text)}

/* â•â•â•â•â•â•â•â•â•â•â• Code Blocks â•â•â•â•â•â•â•â•â•â•â• */
.code-block{background:#0D1117;border:1px solid var(--border);border-radius:var(--radius);overflow:hidden;margin:20px 0}
.code-header{display:flex;align-items:center;justify-content:space-between;padding:10px 16px;background:#161B22;border-bottom:1px solid var(--border);font-size:12px;color:var(--text3)}
.code-header .lang{display:flex;align-items:center;gap:6px}
.code-header .file{color:var(--text2)}
.code-block pre{margin:0;padding:20px;overflow-x:auto}
.code-block code{font-family:'JetBrains Mono',monospace;font-size:13px;line-height:1.65}

/* â•â•â•â•â•â•â•â•â•â•â• Tables â•â•â•â•â•â•â•â•â•â•â• */
.table-wrap{overflow-x:auto;margin:20px 0;border-radius:var(--radius);border:1px solid var(--border)}
table{width:100%;border-collapse:collapse;font-size:14px}
th{background:var(--bg3);font-weight:600;text-align:left;padding:12px 16px;color:var(--text2);font-size:12px;text-transform:uppercase;letter-spacing:.5px;white-space:nowrap}
td{padding:12px 16px;border-top:1px solid var(--border);color:var(--text2)}
tr:hover td{background:var(--bg2)}
td:first-child{color:var(--text);font-weight:600}
.tag{display:inline-flex;padding:2px 10px;border-radius:4px;font-size:11px;font-weight:600}
.tag-blue{background:var(--blue-bg);color:var(--blue)}
.tag-green{background:var(--green-bg);color:var(--green)}
.tag-yellow{background:var(--yellow-bg);color:var(--yellow)}
.tag-purple{background:var(--purple-bg);color:var(--purple)}
.tag-red{background:#EF444420;color:var(--red)}

/* â•â•â•â•â•â•â•â•â•â•â• KPI Cards â•â•â•â•â•â•â•â•â•â•â• */
.kpi-cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px;margin:32px 0}
.kpi{background:var(--bg2);border:1px solid var(--border);border-radius:var(--radius);padding:24px;text-align:center}
.kpi .kpi-label{font-size:11px;color:var(--text3);text-transform:uppercase;letter-spacing:.5px;margin-bottom:8px}
.kpi .kpi-value{font-size:32px;font-weight:800;color:var(--text)}
.kpi .kpi-change{font-size:12px;margin-top:6px}
.kpi .kpi-change.up{color:var(--green)}
.kpi .kpi-change.down{color:var(--red)}

/* â•â•â•â•â•â•â•â•â•â•â• Funnel â•â•â•â•â•â•â•â•â•â•â• */
.funnel{display:flex;align-items:center;gap:8px;margin:32px 0;overflow-x:auto;padding:8px 0}
.funnel-step{flex:1;min-width:160px;text-align:center;padding:24px 16px;border-radius:var(--radius);position:relative}
.funnel-step .f-label{font-size:12px;color:var(--text2);margin-bottom:8px}
.funnel-step .f-value{font-size:24px;font-weight:800;color:var(--text)}
.funnel-step .f-pct{font-size:13px;font-weight:600;margin-top:6px}
.funnel-arrow{color:var(--text3);font-size:20px;flex-shrink:0}

/* â•â•â•â•â•â•â•â•â•â•â• Flow Diagrams â•â•â•â•â•â•â•â•â•â•â• */
.flow{background:var(--bg2);border:1px solid var(--border);border-radius:var(--radius);padding:20px;margin:16px 0;font-family:'JetBrains Mono',monospace;font-size:12px;color:var(--text2);line-height:1.6;white-space:pre;overflow-x:auto}

/* â•â•â•â•â•â•â•â•â•â•â• Timeline/Steps â•â•â•â•â•â•â•â•â•â•â• */
.steps{display:flex;flex-direction:column;gap:0;margin:32px 0}
.step{display:flex;gap:24px;position:relative;padding-bottom:32px}
.step:last-child{padding-bottom:0}
.step::before{content:'';position:absolute;left:19px;top:44px;bottom:0;width:2px;background:var(--border)}
.step:last-child::before{display:none}
.step-dot{width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:16px;flex-shrink:0;position:relative;z-index:1}
.step-content h4{font-size:15px;font-weight:700;margin-bottom:4px}
.step-content p{font-size:14px;color:var(--text2)}

/* â•â•â•â•â•â•â•â•â•â•â• Priority Grid â•â•â•â•â•â•â•â•â•â•â• */
.priority-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:16px;margin:24px 0}
.priority-card{border-radius:var(--radius);padding:24px;border:1px solid}
.priority-card.p0{background:#EF444410;border-color:#EF444430}
.priority-card.p1{background:#F59E0B10;border-color:#F59E0B30}
.priority-card.p2{background:#22C55E10;border-color:#22C55E30}
.priority-card h4{font-size:16px;font-weight:700;margin-bottom:8px}
.priority-card p{font-size:13px;color:var(--text2)}

/* â•â•â•â•â•â•â•â•â•â•â• Slack Mock â•â•â•â•â•â•â•â•â•â•â• */
.slack-mock{background:#1A1D21;border-radius:var(--radius);padding:24px;margin:24px 0;border:1px solid #2C2F33;font-size:14px}
.slack-header{display:flex;align-items:center;gap:10px;margin-bottom:16px}
.slack-avatar{width:36px;height:36px;border-radius:8px;background:var(--blue);display:flex;align-items:center;justify-content:center;font-size:16px;font-weight:700;color:#fff}
.slack-name{font-weight:700;color:#D1D2D3;font-size:15px}
.slack-time{color:#616061;font-size:12px;margin-left:8px}
.slack-body{color:#D1D2D3;line-height:1.7}
.slack-body .slack-field{display:inline-block;margin-right:24px;margin-bottom:4px}
.slack-body .slack-field-label{font-weight:700;color:#D1D2D3;font-size:13px}
.slack-body .slack-field-value{color:#D1D2D3;font-size:13px}
.slack-bar{width:4px;background:var(--red);border-radius:4px;margin-right:12px;flex-shrink:0}
.slack-content{display:flex;margin-top:12px;padding:12px 0}
.slack-detail{font-size:13px;color:#ABABAD}
.slack-link{color:#1D9BD1;text-decoration:none}

/* â•â•â•â•â•â•â•â•â•â•â• Dashboard Charts â•â•â•â•â•â•â•â•â•â•â• */
.dashboard-section{background:var(--bg2);border:1px solid var(--border);border-radius:var(--radius);padding:24px;margin:16px 0}
.dashboard-section h4{font-size:15px;font-weight:700;margin-bottom:16px;display:flex;align-items:center;gap:8px}
.chart-tabs{background:var(--bg2);border:1px solid var(--border);border-radius:var(--radius);overflow:hidden;margin:20px 0}
.chart-tab-bar{display:flex;border-bottom:1px solid var(--border);overflow-x:auto}
.chart-tab{flex:1;padding:14px 16px;background:none;border:none;color:var(--text3);font-size:13px;font-weight:600;cursor:pointer;white-space:nowrap;border-bottom:2px solid transparent;transition:.2s;font-family:inherit}
.chart-tab:hover{color:var(--text2);background:var(--bg3)}
.chart-tab.active{color:var(--blue);border-bottom-color:var(--blue)}
.chart-tab-panel{padding:24px}
details.code-collapse{margin:16px 0}
details.code-collapse summary{cursor:pointer;padding:12px 16px;background:#161B22;border:1px solid var(--border);border-radius:var(--radius);font-size:13px;font-weight:600;color:var(--text2);list-style:none;transition:.2s}
details.code-collapse summary::-webkit-details-marker{display:none}
details.code-collapse summary::before{content:'â–¶ ';font-size:10px;transition:.15s;display:inline-block}
details.code-collapse[open] summary::before{transform:rotate(90deg)}
details.code-collapse summary:hover{color:var(--text);background:#1a2030}
details.code-collapse[open] summary{border-radius:var(--radius) var(--radius) 0 0;border-bottom-color:transparent}
details.code-collapse .code-block{margin:0;border-top:none;border-radius:0 0 var(--radius) var(--radius)}

/* â•â•â•â•â•â•â•â•â•â•â• Quality Gauge â•â•â•â•â•â•â•â•â•â•â• */
.quality-row{display:grid;grid-template-columns:repeat(4,1fr);gap:16px;margin:24px 0}
.quality-item{background:var(--bg);border:1px solid var(--border);border-radius:var(--radius-sm);padding:20px;text-align:center}
.quality-item .q-label{font-size:11px;color:var(--text3);text-transform:uppercase;letter-spacing:.5px;margin-bottom:6px}
.quality-item .q-value{font-size:28px;font-weight:800}
.quality-item .q-bar{height:4px;background:var(--bg3);border-radius:2px;margin-top:10px;overflow:hidden}
.quality-item .q-fill{height:100%;border-radius:2px}

/* â•â•â•â•â•â•â•â•â•â•â• Troubleshoot Cards â•â•â•â•â•â•â•â•â•â•â• */
.trouble-card{background:var(--bg2);border:1px solid var(--border);border-radius:var(--radius);padding:28px;margin:20px 0}
.trouble-card h4{font-size:16px;font-weight:700;margin-bottom:4px;display:flex;align-items:center;gap:8px}
.trouble-card .situation{font-size:14px;color:var(--text2);margin:12px 0;padding:16px;background:var(--bg);border-radius:var(--radius-sm);border-left:3px solid var(--red)}
.trouble-card .solution{margin:12px 0}
.trouble-card .solution li{font-size:14px;color:var(--text2);margin-bottom:6px;padding-left:4px}
.trouble-card .lesson{font-size:14px;color:var(--yellow);background:var(--yellow-bg);padding:12px 16px;border-radius:var(--radius-sm);margin-top:12px}

/* â•â•â•â•â•â•â•â•â•â•â• Tech Stack â•â•â•â•â•â•â•â•â•â•â• */
.stack-grid{display:grid;grid-template-columns:auto 1fr;gap:0;border:1px solid var(--border);border-radius:var(--radius);overflow:hidden;margin:24px 0}
.stack-row{display:contents}
.stack-row:nth-child(even) .stack-label,.stack-row:nth-child(even) .stack-value{background:var(--bg3)30}
.stack-label{font-size:12px;font-weight:600;color:var(--text3);text-transform:uppercase;letter-spacing:.5px;padding:14px 20px;border-right:1px solid var(--border);white-space:nowrap}
.stack-value{font-size:14px;color:var(--text);padding:14px 20px;display:flex;align-items:center;gap:8px;flex-wrap:wrap}

/* â•â•â•â•â•â•â•â•â•â•â• Why Table â•â•â•â•â•â•â•â•â•â•â• */
.why-cards{display:grid;gap:16px;margin:24px 0}
.why-card{background:var(--bg2);border:1px solid var(--border);border-radius:var(--radius);padding:24px;display:grid;grid-template-columns:140px 1fr 1fr;gap:20px;align-items:start}
.why-card .why-tech{font-size:15px;font-weight:700;color:var(--blue)}
.why-card .why-reason{font-size:14px;color:var(--text2)}
.why-card .why-alt{font-size:13px;color:var(--text3)}

/* â•â•â•â•â•â•â•â•â•â•â• Footer â•â•â•â•â•â•â•â•â•â•â• */
.footer{text-align:center;padding:48px 32px;border-top:1px solid var(--border)}
.footer h3{font-size:24px;font-weight:800;margin-bottom:12px}
.footer p{color:var(--text2);font-size:14px;margin-bottom:24px}
.footer-links{display:flex;gap:16px;justify-content:center;margin-bottom:32px}
.footer-links a{color:var(--text2);text-decoration:none;padding:8px 20px;border:1px solid var(--border);border-radius:8px;font-size:13px;font-weight:500;transition:.2s}
.footer-links a:hover{border-color:var(--blue);color:var(--blue)}
.footer-copy{font-size:12px;color:var(--text3)}

/* â•â•â•â•â•â•â•â•â•â•â• Responsive â•â•â•â•â•â•â•â•â•â•â• */
@media(max-width:768px){
  .nav-links{display:none}
  .chart-tab{padding:10px 12px;font-size:12px}
  .priority-grid{grid-template-columns:1fr}
  .quality-row{grid-template-columns:repeat(2,1fr)}
  .why-card{grid-template-columns:1fr}
  .jd-row{grid-template-columns:1fr 24px 1fr;padding:12px 16px}
  .funnel{flex-direction:column}
  .funnel-arrow{transform:rotate(90deg)}
}
</style>
</head>
<body>

<!-- â•â•â•â•â•â•â•â•â•â•â• NAV â•â•â•â•â•â•â•â•â•â•â• -->
<nav class="nav">
  <div class="nav-inner">
    <a href="#" class="nav-logo"><span>Quick</span>Pay</a>
    <ul class="nav-links">
      <li><a href="#overview">ê°œìš”</a></li>
      <li><a href="#part1">ë¡œê·¸ì„¤ê³„</a></li>
      <li><a href="#part2">ì§€í‘œì •ì˜</a></li>
      <li><a href="#part3">í’ˆì§ˆê´€ë¦¬</a></li>
      <li><a href="#part4">ì‹œê°í™”</a></li>
      <li><a href="#part5">ìë™í™”</a></li>
      <li><a href="#troubleshoot">íŠ¸ëŸ¬ë¸”ìŠˆíŒ…</a></li>
    </ul>
    <a href="https://github.com" class="nav-cta" target="_blank">GitHub â†’</a>
  </div>
</nav>

<!-- â•â•â•â•â•â•â•â•â•â•â• HERO â•â•â•â•â•â•â•â•â•â•â• -->
<section class="hero" id="overview">
  <div class="hero-badge"><span class="dot"></span> DataOps Portfolio 2024</div>
  <h1>í•€í…Œí¬ DataOps:<br><span class="accent">ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ë°ì´í„° í™˜ê²½ êµ¬ì¶•</span></h1>
  <p class="hero-sub">"ë°ì´í„°ë¥¼ ë§Œë“œëŠ” ê²ƒì´ ì•„ë‹ˆë¼, <strong>ë°ì´í„°ë¥¼ ì‹ ë¢°í•  ìˆ˜ ìˆê²Œ ë§Œë“œëŠ” ê²ƒ</strong>ì´ DataOpsì˜ ë³¸ì§ˆì…ë‹ˆë‹¤."<br>QuickPay â€” ê°€ìƒì˜ ê°„í¸ê²°ì œ ì„œë¹„ìŠ¤ë¥¼ ìœ„í•œ ë°ì´í„° ìš´ì˜ í¬íŠ¸í´ë¦¬ì˜¤</p>
  <div class="hero-stats">
    <div class="hero-stat"><div class="num">5</div><div class="label">Part Portfolio</div></div>
    <div class="hero-stat"><div class="num">18+</div><div class="label">Quality Rules</div></div>
    <div class="hero-stat"><div class="num">6</div><div class="label">dbt Models</div></div>
    <div class="hero-stat"><div class="num">2</div><div class="label">Airflow DAGs</div></div>
  </div>
</section>

<!-- â•â•â•â•â•â•â•â•â•â•â• PROJECT OVERVIEW â•â•â•â•â•â•â•â•â•â•â• -->
<hr class="divider">
<section class="section">
  <div class="section-header">
    <div class="section-label">ğŸ“Œ Project Overview</div>
    <h2 class="section-title">í”„ë¡œì íŠ¸ ê°œìš”</h2>
    <p class="section-desc">PM/ë§ˆì¼€íŒ…/ê²½ì˜ì§„ì´ "ë¯¿ê³  ì“¸ ìˆ˜ ìˆëŠ”" ë°ì´í„° í™˜ê²½ì„ 1ì¸ Full-Cycleë¡œ êµ¬ì¶•í–ˆìŠµë‹ˆë‹¤.</p>
  </div>

  <div class="card" style="margin-bottom:32px">
    <div class="table-wrap" style="margin:0;border:none">
      <table>
        <tr><td style="width:140px">ì„œë¹„ìŠ¤</td><td>QuickPay â€” ê°„í¸ê²°ì œ / ì†¡ê¸ˆ / íˆ¬ì í•€í…Œí¬ í”Œë«í¼</td></tr>
        <tr><td>ì—­í• </td><td>Data Engineer (1ì¸) â€” ë¡œê·¸ ì„¤ê³„ ~ ëŒ€ì‹œë³´ë“œ ìš´ì˜ê¹Œì§€ Full-Cycle</td></tr>
        <tr><td>ê¸°ê°„</td><td>2024.06 ~ í˜„ì¬</td></tr>
        <tr><td>ëª©í‘œ</td><td>PM/ë§ˆì¼€íŒ…/ê²½ì˜ì§„ì´ "ë¯¿ê³  ì“¸ ìˆ˜ ìˆëŠ”" ë°ì´í„° í™˜ê²½ êµ¬ì¶•</td></tr>
      </table>
    </div>
  </div>

  <!-- Tech Stack -->
  <div class="stack-grid">
    <div class="stack-row"><div class="stack-label">ë¡œê·¸ ì„¤ê³„</div><div class="stack-value"><span class="tag tag-blue">Event Taxonomy</span> Category.Action.Label + JSON Schema</div></div>
    <div class="stack-row"><div class="stack-label">ë°ì´í„° ìˆ˜ì§‘</div><div class="stack-value"><span class="tag tag-green">FastAPI</span> Event Collector â†’ Pub/Sub â†’ BigQuery</div></div>
    <div class="stack-row"><div class="stack-label">ë³€í™˜/ëª¨ë¸ë§</div><div class="stack-value"><span class="tag tag-purple">dbt</span> staging â†’ intermediate â†’ mart (3-Layer)</div></div>
    <div class="stack-row"><div class="stack-label">í’ˆì§ˆ ê´€ë¦¬</div><div class="stack-value"><span class="tag tag-yellow">Great Expectations</span> + Slack Alert (P0/P1/P2)</div></div>
    <div class="stack-row"><div class="stack-label">ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜</div><div class="stack-value"><span class="tag tag-blue">Apache Airflow</span> Daily Metrics DAG + Quality DAG</div></div>
    <div class="stack-row"><div class="stack-label">ì‹œê°í™”</div><div class="stack-value"><span class="tag tag-purple">Dashboard</span> Revenue, Funnel, Retention, Quality</div></div>
    <div class="stack-row"><div class="stack-label">ì¸í”„ë¼</div><div class="stack-value"><span class="tag tag-green">GCP</span> BigQuery Â· Pub/Sub Â· GKE + Terraform + Docker</div></div>
  </div>

  <!-- JD Mapping -->
  <h3 style="text-align:center;margin:48px 0 16px;font-size:18px;font-weight:700">ğŸ¯ í† ìŠ¤ JD ë§¤í•‘</h3>
  <div class="jd-map">
    <div class="jd-row"><div class="jd-left">ë¡œê·¸ ì„¤ê³„ ë° ë°ì´í„° ê±°ë²„ë„ŒìŠ¤</div><div class="jd-arrow">â†’</div><div class="jd-right">PART 1: ì´ë²¤íŠ¸ íƒì†Œë…¸ë¯¸ & ìŠ¤í‚¤ë§ˆ ì„¤ê³„</div></div>
    <div class="jd-row"><div class="jd-left">ì§€í‘œ ì •ì˜ ë° ë°ì´í„° ì •í•©ì„± ê´€ë¦¬</div><div class="jd-arrow">â†’</div><div class="jd-right">PART 2: ë©”íŠ¸ë¦­ ë”•ì…”ë„ˆë¦¬ & dbt ëª¨ë¸</div></div>
    <div class="jd-row"><div class="jd-left">ë°ì´í„° QA ë° í’ˆì§ˆ ê´€ë¦¬</div><div class="jd-arrow">â†’</div><div class="jd-right">PART 3: Great Expectations & Slack ì•Œë¦¼</div></div>
    <div class="jd-row"><div class="jd-left">ì‹œê°í™” ë° ì˜ì‚¬ê²°ì • ì§€ì›</div><div class="jd-arrow">â†’</div><div class="jd-right">PART 4: ëŒ€ì‹œë³´ë“œ & ë¶„ì„ ì¿¼ë¦¬</div></div>
    <div class="jd-row"><div class="jd-left">ë°ì´í„° íŒŒì´í”„ë¼ì¸ ìš´ì˜/ìë™í™”</div><div class="jd-arrow">â†’</div><div class="jd-right">PART 5: Airflow DAG & ìš´ì˜ ìë™í™”</div></div>
  </div>
</section>

<!-- â•â•â•â•â•â•â•â•â•â•â• PART 1 â•â•â•â•â•â•â•â•â•â•â• -->
<hr class="divider">
<section class="section" id="part1">
  <div class="section-header">
    <div class="section-label">ğŸ“ Part 1</div>
    <h2 class="section-title">ë¡œê·¸ ì„¤ê³„ & ë°ì´í„° ê±°ë²„ë„ŒìŠ¤</h2>
    <p class="section-desc">"ì¢‹ì€ ë°ì´í„° ë¶„ì„ì€ ì¢‹ì€ ë¡œê·¸ ì„¤ê³„ì—ì„œ ì‹œì‘ë©ë‹ˆë‹¤."</p>
  </div>

  <!-- Why -->
  <div class="card" style="margin-bottom:32px">
    <h3>ğŸ’¡ Why íƒì†Œë…¸ë¯¸ê°€ í•„ìš”í•œê°€?</h3>
    <p style="margin-top:12px">í•€í…Œí¬ ì„œë¹„ìŠ¤ì—ì„œ ë¡œê·¸ ë°ì´í„°ëŠ” ë‹¨ìˆœí•œ ê¸°ë¡ì´ ì•„ë‹ˆë¼ <strong style="color:var(--text)">ë¹„ì¦ˆë‹ˆìŠ¤ ì˜ì‚¬ê²°ì •ì˜ ì›ì²œ</strong>ì…ë‹ˆë‹¤. íƒì†Œë…¸ë¯¸ ì—†ì´ ê°œë°œìê°€ ììœ ë¡­ê²Œ ì´ë²¤íŠ¸ë¥¼ ì •ì˜í•˜ë©´:</p>
    <ul style="margin:12px 0 0 20px;color:var(--text2);font-size:14px">
      <li><code style="color:var(--red)">paymentComplete</code>, <code style="color:var(--red)">payment_done</code>, <code style="color:var(--red)">pay_success</code> â€” ê°™ì€ í–‰ë™, ë‹¤ë¥¸ ì´ë¦„ 3ê°œ</li>
      <li>PMì´ "ê²°ì œ ì „í™˜ìœ¨" í•˜ë‚˜ ë³´ë ¤ë©´ DEì—ê²Œ ë§¤ë²ˆ ì§ˆì˜</li>
      <li>ë¶„ì„ ê²°ê³¼ì˜ ì‹ ë¢°ë„ í•˜ë½ â†’ ë°ì´í„° íŒ€ì— ëŒ€í•œ ë¶ˆì‹ </li>
    </ul>
  </div>

  <!-- Naming Convention -->
  <h3 style="margin-bottom:16px;font-size:17px">Category.Action.Label ë„¤ì´ë° ê·œì¹™</h3>
  <div class="code-block">
    <div class="code-header"><span class="lang">ğŸ“ Event Naming Convention</span><span class="file">01_log_design/event_taxonomy.md</span></div>
    <pre><code class="language-plaintext">{category}.{action}.{label}

ì˜ˆì‹œ:
  payment.view.payment_screen         â†’ ê²°ì œ í™”ë©´ ì§„ì…
  payment.click.payment_method_select â†’ ê²°ì œ ìˆ˜ë‹¨ ì„ íƒ
  payment.submit.payment_request      â†’ ê²°ì œ ìš”ì²­
  payment.complete.payment_success    â†’ ê²°ì œ ì™„ë£Œ
  payment.fail.payment_timeout        â†’ ê²°ì œ ì‹¤íŒ¨ (íƒ€ì„ì•„ì›ƒ)

8ê°œ ì¹´í…Œê³ ë¦¬: auth Â· payment Â· transfer Â· invest Â· benefit Â· notification Â· onboarding Â· error</code></pre>
  </div>

  <!-- Funnel Flow -->
  <h3 style="margin:32px 0 16px;font-size:17px">ê²°ì œ í¼ë„ ì´ë²¤íŠ¸ íë¦„</h3>
  <div class="funnel">
    <div class="funnel-step" style="background:var(--blue-bg)"><div class="f-label">payment.view.*</div><div class="f-value" style="font-size:18px">ì§„ì…</div></div>
    <div class="funnel-arrow">â†’</div>
    <div class="funnel-step" style="background:var(--purple-bg)"><div class="f-label">payment.click.*</div><div class="f-value" style="font-size:18px">ìˆ˜ë‹¨ ì„ íƒ</div></div>
    <div class="funnel-arrow">â†’</div>
    <div class="funnel-step" style="background:#EC489920"><div class="f-label">payment.submit.*</div><div class="f-value" style="font-size:18px">ê²°ì œ ìš”ì²­</div></div>
    <div class="funnel-arrow">â†’</div>
    <div class="funnel-step" style="background:var(--green-bg)"><div class="f-label">payment.complete.*</div><div class="f-value" style="font-size:18px">ì™„ë£Œ/ì‹¤íŒ¨</div></div>
  </div>

  <!-- Schema -->
  <h3 style="margin:32px 0 16px;font-size:17px">ì´ë²¤íŠ¸ ìŠ¤í‚¤ë§ˆ (JSON Schema v1.2.0)</h3>
  <div class="code-block">
    <div class="code-header"><span class="lang">ğŸ”§ JSON</span><span class="file">01_log_design/event_schema.json</span></div>
    <pre><code class="language-json">{
  "event_id": "evt_a1b2c3d4e5",
  "event_name": "payment.complete.payment_success",
  "event_timestamp": "2024-12-15T14:23:45.123Z",
  "user_id": "usr_12345",
  "session_id": "ses_abcde",
  "device_id": "dev_xyz",
  "device_type": "ios",
  "app_version": "3.2.1",
  "properties": {
    "amount": 50000,
    "payment_method": "quickpay_balance",
    "transaction_id": "TXN-A1B2C3D4",
    "merchant_category": "food_delivery"
  }
}</code></pre>
  </div>

  <div class="card-grid cols-3" style="margin-top:24px">
    <div class="card">
      <h3>ğŸ” ì •ê·œì‹ ê²€ì¦</h3>
      <p><code style="color:var(--blue)">^[a-z]+\.[a-z]+\.[a-z_]+$</code><br>event_name íŒ¨í„´ ê°•ì œ</p>
    </div>
    <div class="card">
      <h3>ğŸ“‹ í•„ìˆ˜ 8ê°œ í•„ë“œ</h3>
      <p>event_id, event_name, event_timestamp, user_id, session_id, device_id, device_type, app_version</p>
    </div>
    <div class="card">
      <h3>ğŸ“– ê°œë°œì ê°€ì´ë“œ</h3>
      <p>iOS (Swift), Android (Kotlin), Backend (Python) SDK ì˜ˆì‹œ + ê³µí†µ ì‹¤ìˆ˜ ëª©ë¡ ì œê³µ</p>
    </div>
  </div>
</section>

<!-- â•â•â•â•â•â•â•â•â•â•â• PART 2 â•â•â•â•â•â•â•â•â•â•â• -->
<hr class="divider">
<section class="section" id="part2">
  <div class="section-header">
    <div class="section-label">ğŸ“Š Part 2</div>
    <h2 class="section-title">ì§€í‘œ ì •ì˜ & ë°ì´í„° ì •í•©ì„±</h2>
    <p class="section-desc">"ëª¨ë‘ê°€ ê°™ì€ ìˆ«ìë¥¼ ë³´ê³  ìˆë‹¤ê³  í™•ì‹ í•  ìˆ˜ ìˆì–´ì•¼ í•©ë‹ˆë‹¤."</p>
  </div>

  <!-- Why -->
  <div class="card" style="margin-bottom:32px">
    <h3>ğŸ’¡ Why ë©”íŠ¸ë¦­ ë”•ì…”ë„ˆë¦¬?</h3>
    <p style="margin-top:12px">PMì´ "DAUê°€ ëª‡ì´ì•¼?"ë¼ê³  ë¬¼ì—ˆì„ ë•Œ, ì‚¬ëŒë§ˆë‹¤ ë‹¤ë¥¸ ìˆ«ìë¥¼ ëŒ€ë‹µí•˜ë©´?</p>
    <ul style="margin:12px 0 0 20px;color:var(--text2);font-size:14px">
      <li>ë§ˆì¼€íŒ…: "ì•± ì„¤ì¹˜ í›„ 1íšŒ ì´ìƒ ì ‘ì† = <strong style="color:var(--text)">120ë§Œ</strong>"</li>
      <li>í”„ë¡œë•íŠ¸: "ë¡œê·¸ì¸í•œ ìœ ì € = <strong style="color:var(--text)">98ë§Œ</strong>"</li>
      <li>ê²½ì˜ì§„: "ê²°ì œí•œ ìœ ì € = <strong style="color:var(--text)">45ë§Œ</strong>"</li>
    </ul>
    <p style="margin-top:12px;color:var(--blue);font-weight:600">â†’ í•˜ë‚˜ì˜ ì§€í‘œ = í•˜ë‚˜ì˜ ì •ì˜ = í•˜ë‚˜ì˜ SQL</p>
  </div>

  <!-- Metrics Table -->
  <div class="table-wrap">
    <table>
      <thead><tr><th>ì§€í‘œ</th><th>ì •ì˜</th><th>ì‚°ì‹</th></tr></thead>
      <tbody>
        <tr><td>DAU</td><td>í•˜ë£¨ ì¤‘ ë¡œê·¸ì¸ ì´ë²¤íŠ¸ 1íšŒ ì´ìƒ ê³ ìœ  ìœ ì € ìˆ˜</td><td><code>COUNT(DISTINCT user_id) WHERE event = 'auth.complete.login'</code></td></tr>
        <tr><td>ARPPU</td><td>ê²°ì œ ìœ ì € 1ì¸ë‹¹ í‰ê·  ìˆœë§¤ì¶œ</td><td><code>SUM(net_revenue) / COUNT(DISTINCT paying_user_id)</code></td></tr>
        <tr><td>D7 Retention</td><td>ê°€ì… í›„ 7ì¼ì§¸ ì¬ë°©ë¬¸í•œ ìœ ì € ë¹„ìœ¨</td><td><code>D7_active_users / cohort_size Ã— 100</code></td></tr>
        <tr><td>Payment CVR</td><td>ê²°ì œ í™”ë©´ ì§„ì… ëŒ€ë¹„ ê²°ì œ ì™„ë£Œ ë¹„ìœ¨</td><td><code>complete_sessions / view_sessions Ã— 100</code></td></tr>
        <tr><td>Error Rate</td><td>ì „ì²´ ê²°ì œ ì‹œë„ ì¤‘ ì‹¤íŒ¨ ë¹„ìœ¨</td><td><code>failed_txn / total_txn Ã— 100</code></td></tr>
      </tbody>
    </table>
  </div>

  <!-- ARPPU SQL -->
  <details class="code-collapse">
    <summary>ğŸ’ í•€í…Œí¬ ARPPU SQL â€” ì¤‘ë³µ ê²°ì œ ì œê±° + í™˜ë¶ˆ ì°¨ê°</summary>
  <div class="code-block">
    <div class="code-header"><span class="lang">SQL (BigQuery)</span><span class="file">02_metrics_definition/metrics_sql/arppu.sql</span></div>
    <pre><code class="language-sql">WITH payments AS (
    SELECT
        DATE(e.event_timestamp) AS dt,
        e.user_id,
        e.properties.transaction_id,
        e.properties.amount AS gross_amount,
        -- ì¤‘ë³µ ê²°ì œ ë°©ì§€: ë™ì¼ transaction_id ì¤‘ ìµœì´ˆ ê±´ë§Œ ìœ íš¨
        ROW_NUMBER() OVER (
            PARTITION BY e.properties.transaction_id
            ORDER BY e.event_timestamp ASC
        ) AS txn_rank
    FROM {{ ref('stg_events') }} e
    WHERE e.event_name = 'payment.complete.payment_success'
      AND e.properties.amount > 0
),
valid_payments AS (
    SELECT * FROM payments WHERE txn_rank = 1  -- ì¤‘ë³µ ì œê±°
),
refunds AS (
    SELECT e.properties.transaction_id,
           e.properties.amount AS refund_amount
    FROM {{ ref('stg_events') }} e
    WHERE e.event_name = 'payment.complete.refund'
)
SELECT
    dt,
    COUNT(DISTINCT user_id) AS paying_users,
    SUM(gross_amount) AS gross_revenue,
    SUM(refund_amount) AS total_refunds,
    SUM(gross_amount - COALESCE(refund_amount, 0)) AS net_revenue,
    -- â˜… ARPPU
    SAFE_DIVIDE(
        SUM(gross_amount - COALESCE(refund_amount, 0)),
        COUNT(DISTINCT user_id)
    ) AS arppu
FROM valid_payments p
LEFT JOIN refunds r ON p.transaction_id = r.transaction_id
GROUP BY dt</code></pre>
  </div>
  </details>

  <div class="card-grid cols-2" style="margin-top:24px">
    <div class="card"><h3>ğŸ”„ ì¤‘ë³µ ê²°ì œ ì œê±°</h3><p><code>ROW_NUMBER() PARTITION BY transaction_id</code> â€” ë™ì¼ íŠ¸ëœì­ì…˜ ì¤‘ ìµœì´ˆ ê±´ë§Œ ìœ íš¨ ì²˜ë¦¬</p></div>
    <div class="card"><h3>ğŸ’° í™˜ë¶ˆ ì²˜ë¦¬</h3><p>Gross Revenue - Refund = <strong style="color:var(--green)">Net Revenue</strong> â€” ë¶€ë¶„ í™˜ë¶ˆë„ ì •í™•íˆ ì°¨ê°</p></div>
    <div class="card"><h3>ğŸš« ì·¨ì†Œ ê±´ ì œì™¸</h3><p><code>amount > 0</code> í•„í„°ë¡œ ì·¨ì†Œ/ë¬´íš¨ ê²°ì œ ì™„ì „ ì œê±°</p></div>
    <div class="card"><h3>ğŸ“Š SAFE_DIVIDE</h3><p>BigQuery ì „ìš© â€” 0ìœ¼ë¡œ ë‚˜ëˆ„ê¸° ì‹œ NULL ë°˜í™˜ìœ¼ë¡œ ì—ëŸ¬ ë°©ì§€</p></div>
  </div>

  <!-- dbt Model -->
  <h3 style="margin:48px 0 16px;font-size:17px">dbt 3-Layer ì•„í‚¤í…ì²˜</h3>
  <div class="flow">Raw (BigQuery)
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  <span style="color:var(--blue)">Staging (VIEW)</span>                         â”‚
â”‚  stg_events       â€” ì´ë²¤íŠ¸ ì •ê·œí™”       â”‚
â”‚  stg_transactions â€” ê²°ì œ/ì†¡ê¸ˆ í†µí•©       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  <span style="color:var(--purple)">Intermediate (EPHEMERAL)</span>                 â”‚
â”‚  int_user_sessions â€” ì„¸ì…˜ ì§‘ê³„           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  <span style="color:var(--green)">Mart (TABLE, partitioned)</span>                â”‚
â”‚  mart_revenue        â€” ë§¤ì¶œ ë¶„ì„         â”‚
â”‚  mart_payment_funnel â€” í¼ë„ ì „í™˜ìœ¨       â”‚
â”‚  mart_user_retention â€” ì½”í˜¸íŠ¸ ë¦¬í…ì…˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</div>

  <div class="table-wrap">
    <table>
      <thead><tr><th>Layer</th><th>Materialization</th><th>Why</th></tr></thead>
      <tbody>
        <tr><td><span class="tag tag-blue">Staging</span></td><td>VIEW</td><td>ì›ë³¸ì— ê°€ê¹Œì›€. ë§¤ë²ˆ freshí•œ ë°ì´í„° ë³´ì¥. ìŠ¤í† ë¦¬ì§€ ë¹„ìš© â‚©0</td></tr>
        <tr><td><span class="tag tag-purple">Intermediate</span></td><td>EPHEMERAL</td><td>CTEë¡œ ì¸ë¼ì¸ë¨. í…Œì´ë¸” ìƒì„± ë¶ˆí•„ìš”í•œ ì¤‘ê°„ ë¡œì§</td></tr>
        <tr><td><span class="tag tag-green">Mart</span></td><td>TABLE</td><td>BI ë„êµ¬ì—ì„œ ì§ì ‘ ì¡°íšŒ. íŒŒí‹°ì…”ë‹ìœ¼ë¡œ ìŠ¤ìº” ë¹„ìš© ìµœì í™”</td></tr>
      </tbody>
    </table>
  </div>

  <!-- dbt Tests -->
  <h3 style="margin:32px 0 16px;font-size:17px">dbt ë°ì´í„° í…ŒìŠ¤íŠ¸ (3ì¢…)</h3>
  <div class="card-grid cols-3">
    <div class="card"><div class="card-icon" style="background:var(--green-bg)">âœ…</div><h3>assert_revenue_not_negative</h3><p>ìˆœë§¤ì¶œ(Net Revenue)ì´ ìŒìˆ˜ì¸ í–‰ ê°ì§€</p></div>
    <div class="card"><div class="card-icon" style="background:var(--yellow-bg)">ğŸ“Š</div><h3>assert_arppu_reasonable</h3><p>Z-score > 3 ì´ìƒì¹˜ ìë™ ê°ì§€ â€” í†µê³„ì  ì´ìƒ íƒì§€</p></div>
    <div class="card"><div class="card-icon" style="background:var(--blue-bg)">ğŸ”‘</div><h3>assert_unique_transaction_id</h3><p>íŠ¸ëœì­ì…˜ ID ì¤‘ë³µ ê°ì§€ â€” ì´ì¤‘ ê²°ì œ ë°©ì§€</p></div>
  </div>
</section>

<!-- â•â•â•â•â•â•â•â•â•â•â• PART 3 â•â•â•â•â•â•â•â•â•â•â• -->
<hr class="divider">
<section class="section" id="part3">
  <div class="section-header">
    <div class="section-label">ğŸ›¡ï¸ Part 3</div>
    <h2 class="section-title">ë°ì´í„° í’ˆì§ˆ & QA</h2>
    <p class="section-desc">"ë°ì´í„° í’ˆì§ˆ ë¬¸ì œë¥¼ ë°œê²¬í•˜ëŠ” ê²ƒì€ ì‚¬ëŒì´ ì•„ë‹ˆë¼ ì‹œìŠ¤í…œì´ì–´ì•¼ í•©ë‹ˆë‹¤."</p>
  </div>

  <!-- Why GE -->
  <div class="table-wrap" style="margin-bottom:32px">
    <table>
      <thead><tr><th>ëŒ€ì•ˆ</th><th>ì¥ì </th><th>ë‹¨ì </th><th>ì„ íƒ</th></tr></thead>
      <tbody>
        <tr><td>dbt testë§Œ</td><td>dbt ë‚´ì¥, ê°„í¸</td><td>ë³µì¡í•œ ë¶„í¬/í†µê³„ ê²€ì¦ ë¶ˆê°€</td><td></td></tr>
        <tr><td>ì§ì ‘ SQL ê²€ì¦</td><td>ìœ ì—°</td><td>ê·œì¹™ ê´€ë¦¬/ì¬ì‚¬ìš© ì–´ë ¤ì›€</td><td></td></tr>
        <tr><td style="color:var(--green);font-weight:700">Great Expectations</td><td>ì„ ì–¸ì  ê·œì¹™ + Data Docs + Checkpoint</td><td>í•™ìŠµ ê³¡ì„ </td><td><span class="tag tag-green">âœ… ì„ íƒ</span></td></tr>
      </tbody>
    </table>
  </div>

  <!-- Priority System -->
  <h3 style="margin-bottom:16px;font-size:17px">í’ˆì§ˆ ê·œì¹™ ì²´ê³„ (Priority)</h3>
  <div class="priority-grid">
    <div class="priority-card p0">
      <h4>ğŸš¨ P0 â€” Critical</h4>
      <p><strong>ê¸°ì¤€:</strong> ë¶„ì„ ë¶ˆê°€ ìˆ˜ì¤€<br><strong>ì˜ˆì‹œ:</strong> event_id NULL, amount ìŒìˆ˜<br><strong>ì¡°ì¹˜:</strong> ì¦‰ì‹œ ì•Œë¦¼ + íŒŒì´í”„ë¼ì¸ ì¤‘ë‹¨</p>
    </div>
    <div class="priority-card p1">
      <h4>âš ï¸ P1 â€” Warning</h4>
      <p><strong>ê¸°ì¤€:</strong> ë¶„ì„ ì™œê³¡ ê°€ëŠ¥<br><strong>ì˜ˆì‹œ:</strong> device_type ì´ìƒê°’, í‰ê·  ê¸ˆì•¡ ì´íƒˆ<br><strong>ì¡°ì¹˜:</strong> ì•Œë¦¼ + ìˆ˜ë™ í™•ì¸</p>
    </div>
    <div class="priority-card p2">
      <h4>â„¹ï¸ P2 â€” Info</h4>
      <p><strong>ê¸°ì¤€:</strong> ê²½ë¯¸í•œ ì´ìƒ<br><strong>ì˜ˆì‹œ:</strong> ì„¸ì…˜ ì¹´ë””ë„ë¦¬í‹° ë³€ë™<br><strong>ì¡°ì¹˜:</strong> Daily Summary í¬í•¨</p>
    </div>
  </div>

  <!-- Quality Rules -->
  <h3 style="margin:32px 0 16px;font-size:17px">ì£¼ìš” í’ˆì§ˆ ê·œì¹™</h3>
  <div class="card-grid cols-2">
    <div class="card">
      <h3>ğŸ“‹ ì´ë²¤íŠ¸ ë¡œê·¸ (10ê°œ ê·œì¹™)</h3>
      <div style="font-family:'JetBrains Mono',monospace;font-size:13px;color:var(--text2);margin-top:12px;line-height:2">
        <div><span class="tag tag-red">P0</span> event_id NOT NULL & UNIQUE</div>
        <div><span class="tag tag-red">P0</span> user_id NOT NULL</div>
        <div><span class="tag tag-red">P0</span> event_name regex: Category.Action.Label</div>
        <div><span class="tag tag-yellow">P1</span> device_type IN ('ios','android','web')</div>
        <div><span class="tag tag-red">P0</span> amount BETWEEN 0 AND 100,000,000</div>
        <div><span class="tag tag-yellow">P1</span> row_count BETWEEN 10K AND 50M</div>
      </div>
    </div>
    <div class="card">
      <h3>ğŸ’³ íŠ¸ëœì­ì…˜ (8ê°œ ê·œì¹™)</h3>
      <div style="font-family:'JetBrains Mono',monospace;font-size:13px;color:var(--text2);margin-top:12px;line-height:2">
        <div><span class="tag tag-red">P0</span> transaction_id NOT NULL & UNIQUE</div>
        <div><span class="tag tag-red">P0</span> amount > 0 (ìŒìˆ˜ ê²°ì œ ë¶ˆê°€)</div>
        <div><span class="tag tag-red">P0</span> status IN (COMPLETED, REFUNDED, ...)</div>
        <div><span class="tag tag-yellow">P1</span> payment_method IN (card, quickpay, ...)</div>
        <div><span class="tag tag-yellow">P1</span> AVG(amount) BETWEEN 1K AND 500K</div>
      </div>
    </div>
  </div>

  <!-- Alert Flow -->
  <h3 style="margin:32px 0 16px;font-size:17px">Slack ì•Œë¦¼ ì‹œìŠ¤í…œ</h3>
  <div class="flow" style="text-align:center">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Great Expectationsâ”‚â”€â”€â”€â”€â–¶â”‚ <span style="color:var(--blue)">slack_alert.py</span>â”‚â”€â”€â”€â”€â–¶â”‚ Slack Channels   â”‚
â”‚ Checkpoint ì‹¤í–‰   â”‚     â”‚ ê²°ê³¼ íŒŒì‹±     â”‚     â”‚ #critical / #warnâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â–¼          â–¼          â–¼
                <span style="color:var(--red)">P0 â†’ ì¤‘ë‹¨</span>   <span style="color:var(--yellow)">P1 â†’ í™•ì¸</span>   <span style="color:var(--green)">P2 â†’ Summary</span></div>

  <!-- Slack Mock -->
  <h3 style="margin:32px 0 16px;font-size:17px">Slack ì•Œë¦¼ ì˜ˆì‹œ (P0)</h3>
  <div class="slack-mock">
    <div class="slack-header">
      <div class="slack-avatar">Q</div>
      <div><span class="slack-name">QuickPay Data Quality Bot</span><span class="slack-time">02:15 AM</span></div>
    </div>
    <div style="font-size:16px;font-weight:700;color:#D1D2D3;margin-bottom:12px">ğŸš¨ [P0] ë°ì´í„° í’ˆì§ˆ ê²€ì¦ ì‹¤íŒ¨</div>
    <div class="slack-body" style="display:grid;grid-template-columns:1fr 1fr;gap:8px 32px;font-size:13px;margin-bottom:16px">
      <div><span class="slack-field-label">Suite:</span> quickpay_events_suite</div>
      <div><span class="slack-field-label">ì‹¤í–‰ì¼:</span> 2024-12-15 02:15:00</div>
      <div><span class="slack-field-label">ì‹¤íŒ¨ ê±´ìˆ˜:</span> 2ê±´</div>
      <div><span class="slack-field-label">ì¡°ì¹˜:</span> <span style="color:var(--red)">íŒŒì´í”„ë¼ì¸ ì¤‘ë‹¨</span></div>
    </div>
    <div style="border-top:1px solid #2C2F33;padding-top:12px">
      <div style="font-size:13px;font-weight:700;color:#D1D2D3;margin-bottom:8px">ì‹¤íŒ¨ ìƒì„¸:</div>
      <div class="slack-content">
        <div class="slack-bar"></div>
        <div>
          <div class="slack-detail">â€¢ <code>user_id</code> â€” ìœ ì € ID í•„ìˆ˜ â€” ì—†ìœ¼ë©´ í–‰ë™ ë¶„ì„ ë¶ˆê°€ (ì´ìƒ ë¹„ìœ¨: 2.0%)</div>
          <div class="slack-detail">â€¢ <code>properties.amount</code> â€” ê²°ì œ ê¸ˆì•¡ ìŒìˆ˜ ë¶ˆê°€ (ì´ìƒ ë¹„ìœ¨: 0.1%)</div>
        </div>
      </div>
    </div>
    <div style="margin-top:12px;font-size:13px"><a class="slack-link" href="#">ğŸ”— Data Docsì—ì„œ ì „ì²´ ê²°ê³¼ í™•ì¸</a> <span style="color:#E01E5A;font-weight:700">@channel</span></div>
  </div>

  <details class="code-collapse">
    <summary>ğŸ Slack ì•Œë¦¼ ì‹œìŠ¤í…œ ì½”ë“œ â€” slack_alert.py</summary>
  <div class="code-block">
    <div class="code-header"><span class="lang">Python</span><span class="file">07_data_quality/slack_alert.py</span></div>
    <pre><code class="language-python">PRIORITY_CONFIG = {
    "P0": {
        "channel": "#data-alert-critical",
        "color": "#FF0000",
        "emoji": "ğŸš¨",
        "action": "íŒŒì´í”„ë¼ì¸ ì¤‘ë‹¨",
        "mention": "&lt;!channel&gt;",
    },
    "P1": {
        "channel": "#data-alert",
        "emoji": "âš ï¸",
        "action": "ìˆ˜ë™ í™•ì¸ í•„ìš”",
    },
    "P2": {
        "channel": "#data-daily-summary",
        "emoji": "â„¹ï¸",
        "action": "ì¼ì¼ ë¦¬í¬íŠ¸ í¬í•¨",
    },
}

def on_validation_complete(validation_result, suite_name):
    """GE Checkpoint ì™„ë£Œ í›„ ìë™ í˜¸ì¶œ â€” ê²°ê³¼ íŒŒì‹± â†’ Slack ì•Œë¦¼."""
    failures = parse_validation_result(validation_result)
    if not failures:
        return {"success": True, "alert_sent": False}

    max_priority = "P0" if any(f["priority"]=="P0" for f in failures) else "P1"
    message = build_slack_message(suite_name, failures, max_priority)
    send_slack_alert(message)

    if max_priority == "P0":
        raise DataQualityError(f"P0 ì‹¤íŒ¨ â€” íŒŒì´í”„ë¼ì¸ ì¤‘ë‹¨")
    return {"success": False, "should_halt": max_priority == "P0"}</code></pre>
  </div>
  </details>
</section>

<!-- â•â•â•â•â•â•â•â•â•â•â• PART 4 â•â•â•â•â•â•â•â•â•â•â• -->
<hr class="divider">
<section class="section" id="part4">
  <div class="section-header">
    <div class="section-label">ğŸ“ˆ Part 4</div>
    <h2 class="section-title">ì‹œê°í™” & ì˜ì‚¬ê²°ì • ì§€ì›</h2>
    <p class="section-desc">"ì¢‹ì€ ëŒ€ì‹œë³´ë“œëŠ” ì§ˆë¬¸ì— ë‹µí•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, ì˜¬ë°”ë¥¸ ì§ˆë¬¸ì„ í•˜ê²Œ ë§Œë“­ë‹ˆë‹¤."</p>
  </div>

  <!-- Live KPI -->
  <div class="kpi-cards">
    <div class="kpi"><div class="kpi-label">DAU</div><div class="kpi-value">1.24M</div><div class="kpi-change up">â–² 3.2% vs yesterday</div></div>
    <div class="kpi"><div class="kpi-label">Net Revenue</div><div class="kpi-value">â‚©4.8B</div><div class="kpi-change up">â–² 7.1% vs yesterday</div></div>
    <div class="kpi"><div class="kpi-label">ARPPU</div><div class="kpi-value">â‚©12,400</div><div class="kpi-change down">â–¼ 1.3% vs yesterday</div></div>
    <div class="kpi"><div class="kpi-label">Payment CVR</div><div class="kpi-value">68.4%</div><div class="kpi-change up">â–² 2.1% vs yesterday</div></div>
    <div class="kpi"><div class="kpi-label">D7 Retention</div><div class="kpi-value">42.3%</div><div class="kpi-change up">â–² 0.8% vs last week</div></div>
  </div>

  <!-- Payment Funnel -->
  <div class="dashboard-section">
    <h4>ğŸ’³ ê²°ì œ í¼ë„ ì „í™˜ìœ¨ <span class="tag tag-blue" style="margin-left:8px">REAL-TIME</span></h4>
    <div class="funnel">
      <div class="funnel-step" style="background:var(--blue-bg)"><div class="f-label">ê²°ì œ í™”ë©´ ì§„ì…</div><div class="f-value">524,300</div><div class="f-pct" style="color:var(--blue)">100%</div></div>
      <div class="funnel-arrow">â†’</div>
      <div class="funnel-step" style="background:var(--purple-bg)"><div class="f-label">ê²°ì œ ìˆ˜ë‹¨ ì„ íƒ</div><div class="f-value">418,200</div><div class="f-pct" style="color:var(--purple)">79.8%</div></div>
      <div class="funnel-arrow">â†’</div>
      <div class="funnel-step" style="background:#EC489920"><div class="f-label">ê²°ì œ ìš”ì²­</div><div class="f-value">387,600</div><div class="f-pct" style="color:var(--pink)">73.9%</div></div>
      <div class="funnel-arrow">â†’</div>
      <div class="funnel-step" style="background:var(--green-bg)"><div class="f-label">ê²°ì œ ì™„ë£Œ</div><div class="f-value">358,500</div><div class="f-pct" style="color:var(--green)">68.4%</div></div>
    </div>
    <p style="font-size:13px;color:var(--text3);text-align:center;margin-top:8px">ê°€ì¥ í° ì´íƒˆ êµ¬ê°„: <strong style="color:var(--yellow)">ê²°ì œ í™”ë©´ â†’ ìˆ˜ë‹¨ ì„ íƒ (20.2% ì´íƒˆ)</strong> â†’ UX ê°œì„  ì¸ì‚¬ì´íŠ¸</p>
  </div>

  <!-- Charts (Tabbed) -->
  <div class="chart-tabs">
    <div class="chart-tab-bar">
      <button class="chart-tab active" data-tab="tab-revenue">ğŸ“ˆ ë§¤ì¶œ</button>
      <button class="chart-tab" data-tab="tab-dau">ğŸ‘¥ ìœ ì €</button>
      <button class="chart-tab" data-tab="tab-retention">ğŸ”„ ë¦¬í…ì…˜</button>
      <button class="chart-tab" data-tab="tab-payment">ğŸ’° ê²°ì œìˆ˜ë‹¨</button>
      <button class="chart-tab" data-tab="tab-volume">ğŸ” ë³¼ë¥¨</button>
    </div>
    <div class="chart-tab-panel active" id="tab-revenue">
      <canvas id="revenueChart" height="280"></canvas>
    </div>
    <div class="chart-tab-panel" id="tab-dau">
      <canvas id="dauChart" height="280"></canvas>
    </div>
    <div class="chart-tab-panel" id="tab-retention">
      <canvas id="retentionChart" height="280"></canvas>
    </div>
    <div class="chart-tab-panel" id="tab-payment">
      <canvas id="paymentChart" height="280"></canvas>
    </div>
    <div class="chart-tab-panel" id="tab-volume">
      <canvas id="volumeChart" height="280"></canvas>
    </div>
  </div>

  <!-- Data Quality Gauge -->
  <div class="dashboard-section">
    <h4>ğŸ›¡ï¸ ë°ì´í„° í’ˆì§ˆ ëª¨ë‹ˆí„°ë§ <span class="tag tag-green" style="margin-left:8px">ALL PASS</span></h4>
    <div class="quality-row">
      <div class="quality-item"><div class="q-label">Completeness</div><div class="q-value" style="color:var(--green)">99.8%</div><div class="q-bar"><div class="q-fill" style="width:99.8%;background:var(--green)"></div></div></div>
      <div class="quality-item"><div class="q-label">Uniqueness</div><div class="q-value" style="color:var(--green)">100%</div><div class="q-bar"><div class="q-fill" style="width:100%;background:var(--green)"></div></div></div>
      <div class="quality-item"><div class="q-label">Consistency</div><div class="q-value" style="color:var(--green)">99.2%</div><div class="q-bar"><div class="q-fill" style="width:99.2%;background:var(--green)"></div></div></div>
      <div class="quality-item"><div class="q-label">Freshness</div><div class="q-value" style="color:var(--green)">&lt; 5min</div><div class="q-bar"><div class="q-fill" style="width:95%;background:var(--green)"></div></div></div>
    </div>
  </div>

  <!-- SQL Showcase -->
  <details class="code-collapse">
    <summary>ğŸ’ í•µì‹¬ ë¶„ì„ ì¿¼ë¦¬ â€” ì½”í˜¸íŠ¸ ë¦¬í…ì…˜ (CTE 4ë‹¨ê³„, â˜…â˜…â˜…â˜…)</summary>
  <div class="code-block">
    <div class="code-header"><span class="lang">SQL (BigQuery)</span><span class="file">05_sql_queries/retention_analysis.sql</span></div>
    <pre><code class="language-sql">-- Step 1: ìœ ì €ë³„ ìµœì´ˆ í™œë™ì¼ (ì½”í˜¸íŠ¸ ê¸°ì¤€)
WITH user_cohort AS (
    SELECT user_id,
           MIN(DATE(event_timestamp)) AS cohort_date
    FROM staging.events
    WHERE event_name = 'auth.complete.login'
      AND user_id NOT LIKE 'anonymous_%'
    GROUP BY user_id
),
-- Step 2: ìœ ì €ë³„ ì¼ë³„ í™œë™
daily_activity AS (
    SELECT DISTINCT user_id, DATE(event_timestamp) AS active_date
    FROM staging.events
    WHERE event_name = 'auth.complete.login'
),
-- Step 3: ì½”í˜¸íŠ¸ Ã— Day N ë§¤íŠ¸ë¦­ìŠ¤
cohort_retention AS (
    SELECT uc.cohort_date,
           DATE_DIFF(da.active_date, uc.cohort_date, DAY) AS day_n,
           COUNT(DISTINCT uc.user_id) AS retained_users
    FROM user_cohort uc
    INNER JOIN daily_activity da ON uc.user_id = da.user_id
    WHERE DATE_DIFF(da.active_date, uc.cohort_date, DAY) BETWEEN 0 AND 30
    GROUP BY 1, 2
)
-- Step 4: Pivot â†’ D0~D30 ë¦¬í…ì…˜ìœ¨
SELECT cr.cohort_date, cs.cohort_size,
    MAX(CASE WHEN day_n = 1 THEN
        ROUND(SAFE_DIVIDE(retained_users, cs.cohort_size) * 100, 1) END) AS d1,
    MAX(CASE WHEN day_n = 7 THEN
        ROUND(SAFE_DIVIDE(retained_users, cs.cohort_size) * 100, 1) END) AS d7,
    MAX(CASE WHEN day_n = 30 THEN
        ROUND(SAFE_DIVIDE(retained_users, cs.cohort_size) * 100, 1) END) AS d30
FROM cohort_retention cr
JOIN cohort_sizes cs ON cr.cohort_date = cs.cohort_date
GROUP BY 1, 2
HAVING cs.cohort_size >= 50</code></pre>
  </div>
  </details>
</section>

<!-- â•â•â•â•â•â•â•â•â•â•â• PART 5 â•â•â•â•â•â•â•â•â•â•â• -->
<hr class="divider">
<section class="section" id="part5">
  <div class="section-header">
    <div class="section-label">âš™ï¸ Part 5</div>
    <h2 class="section-title">ìš´ì˜ ìë™í™”</h2>
    <p class="section-desc">"ë°˜ë³µë˜ëŠ” ì‘ì—…ì€ ìë™í™”í•˜ê³ , ì‚¬ëŒì€ íŒë‹¨ì— ì§‘ì¤‘í•´ì•¼ í•©ë‹ˆë‹¤."</p>
  </div>

  <!-- DAG 1 -->
  <h3 style="margin-bottom:16px;font-size:17px">Daily Metrics Pipeline</h3>
  <div class="flow" style="text-align:center">ë§¤ì¼ ìƒˆë²½ 02:00 KST
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚<span style="color:var(--blue)"> dbt       </span>â”‚â”€â”€â–¶â”‚<span style="color:var(--blue)"> dbt       </span>â”‚â”€â”€â–¶â”‚<span style="color:var(--blue)"> dbt       </span>â”‚
â”‚<span style="color:var(--blue)"> Staging   </span>â”‚   â”‚<span style="color:var(--blue)"> Mart      </span>â”‚   â”‚<span style="color:var(--blue)"> Test      </span>â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚<span style="color:var(--yellow)"> Quality Check   </span>â”‚
                          â”‚<span style="color:var(--yellow)"> (Great Expect.) </span>â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â–¼
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚<span style="color:var(--purple)"> Dashboard       </span>â”‚
                          â”‚<span style="color:var(--purple)"> Refresh         </span>â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
                           â–¼             â–¼
                     <span style="color:var(--green)">âœ… Success</span>    <span style="color:var(--red)">ğŸš¨ Failure</span></div>

  <!-- DAG 2 -->
  <h3 style="margin:32px 0 16px;font-size:17px">Quality Check Pipeline (6ì‹œê°„ë§ˆë‹¤)</h3>
  <div class="flow" style="text-align:center">06:00, 12:00, 18:00, 00:00 KST
    â”‚
    â”œâ”€â”€â–¶ <span style="color:var(--blue)">ì´ë²¤íŠ¸ í’ˆì§ˆ ê²€ì¦</span>      â”€â”€â”
    â”œâ”€â”€â–¶ <span style="color:var(--purple)">íŠ¸ëœì­ì…˜ í’ˆì§ˆ ê²€ì¦</span>    â”€â”€â”¼â”€â”€â–¶ <span style="color:var(--yellow)">ë¶„ê¸° íŒë‹¨</span> â”€â”€â–¶ Critical / Summary
    â””â”€â”€â–¶ <span style="color:var(--green)">ë³¼ë¥¨ ì´ìƒ ê°ì§€</span>        â”€â”€â”˜</div>

  <div class="card" style="margin:24px 0">
    <h3>ğŸ’¡ Why 2ê°œ DAG ë¶„ë¦¬?</h3>
    <ul style="margin:12px 0 0 20px;color:var(--text2);font-size:14px;line-height:2">
      <li>Daily DAG ì‹¤íŒ¨ ì‹œì—ë„ <strong style="color:var(--text)">í’ˆì§ˆ ëª¨ë‹ˆí„°ë§ì€ ë…ë¦½ ìˆ˜í–‰</strong></li>
      <li>í’ˆì§ˆ ê²€ì¦ ì£¼ê¸°(6h)ì™€ ë©”íŠ¸ë¦­ ì§‘ê³„ ì£¼ê¸°(24h) ìƒì´</li>
      <li>ì¥ì•  ëŒ€ì‘ ì‹œ <strong style="color:var(--text)">ì˜í–¥ ë²”ìœ„ ê²©ë¦¬</strong></li>
    </ul>
  </div>

  <details class="code-collapse">
    <summary>ğŸ Airflow DAG ì½”ë“œ â€” daily_metrics_dag.py</summary>
  <div class="code-block">
    <div class="code-header"><span class="lang">Python</span><span class="file">08_airflow_dags/daily_metrics_dag.py</span></div>
    <pre><code class="language-python">dag = DAG(
    dag_id="quickpay_daily_metrics",
    default_args={
        "owner": "quickpay-dataops",
        "retries": 2,
        "retry_delay": timedelta(minutes=5),
        "execution_timeout": timedelta(hours=1),
    },
    schedule_interval="0 2 * * *",   # ë§¤ì¼ ìƒˆë²½ 2ì‹œ
    catchup=False,
    max_active_runs=1,
)

# Task Dependencies
dbt_staging >> dbt_mart >> dbt_test >> quality_check >> dashboard_refresh
dashboard_refresh >> [success_alert, failure_alert]</code></pre>
  </div>
  </details>

  <!-- Operation Patterns -->
  <div class="table-wrap">
    <table>
      <thead><tr><th>íŒ¨í„´</th><th>êµ¬í˜„</th></tr></thead>
      <tbody>
        <tr><td>ì¬ì‹œë„</td><td><code>retries=2</code>, <code>retry_delay=5min</code> (Daily) / <code>retries=1</code> (Quality)</td></tr>
        <tr><td>íƒ€ì„ì•„ì›ƒ</td><td><code>execution_timeout=1h</code> (Daily) / <code>30min</code> (Quality)</td></tr>
        <tr><td>ë™ì‹œ ì‹¤í–‰ ë°©ì§€</td><td><code>max_active_runs=1</code></td></tr>
        <tr><td>ì‹¤íŒ¨ ì•Œë¦¼</td><td><code>TriggerRule.ONE_FAILED</code> â†’ Slack #data-alert-critical</td></tr>
        <tr><td>ê²°ê³¼ ì „íŒŒ</td><td>XComìœ¼ë¡œ í’ˆì§ˆ ê²°ê³¼ â†’ Summary ì•Œë¦¼ ë©”ì‹œì§€ì— í¬í•¨</td></tr>
      </tbody>
    </table>
  </div>
</section>

<!-- â•â•â•â•â•â•â•â•â•â•â• TROUBLESHOOT â•â•â•â•â•â•â•â•â•â•â• -->
<hr class="divider">
<section class="section" id="troubleshoot">
  <div class="section-header">
    <div class="section-label">ğŸ”§ Troubleshooting</div>
    <h2 class="section-title">íŠ¸ëŸ¬ë¸”ìŠˆíŒ… & ì‹¤íŒ¨ ê²½í—˜</h2>
    <p class="section-desc">"ì‹¤íŒ¨í•˜ì§€ ì•Šì€ ì‹œìŠ¤í…œì€ ì—†ìŠµë‹ˆë‹¤. ì¤‘ìš”í•œ ê²ƒì€ ì–¼ë§ˆë‚˜ ë¹¨ë¦¬ ê°ì§€í•˜ê³  ë³µêµ¬í•˜ëŠëƒì…ë‹ˆë‹¤."</p>
  </div>

  <!-- Case 1 -->
  <div class="trouble-card">
    <h4><span class="tag tag-red" style="margin-right:8px">Case 1</span> ì¤‘ë³µ ê²°ì œ ì´ë²¤íŠ¸ë¡œ ë§¤ì¶œ 2ë°° ì§‘ê³„</h4>
    <div class="situation">
      <strong>ìƒí™©:</strong> í´ë¼ì´ì–¸íŠ¸ SDK ë²„ê·¸ë¡œ <code>payment.complete</code> ì´ë²¤íŠ¸ê°€ 2íšŒ ë°œì†¡ë˜ì–´ ì¼ ë§¤ì¶œì´ ì‹¤ì œì˜ ì•½ 2ë°°ë¡œ ì§‘ê³„ë¨. PMì´ ë³´ê³ ì„œë¥¼ ê²½ì˜ì§„ì— ì „ë‹¬í•œ ë’¤ ë°œê²¬.
    </div>
    <div class="code-block" style="margin:12px 0">
      <div class="code-header"><span class="lang">ğŸ” ì›ì¸ ë¶„ì„</span></div>
      <pre><code class="language-sql">SELECT transaction_id, COUNT(*) AS cnt
FROM staging.events
WHERE event_name = 'payment.complete.payment_success'
GROUP BY 1
HAVING cnt > 1
-- â†’ ì•½ 30%ì˜ ê²°ì œê°€ 2íšŒ ì´ìƒ ê¸°ë¡</code></pre>
    </div>
    <div class="solution">
      <strong>í•´ê²°:</strong>
      <ol style="margin:8px 0 0 20px;color:var(--text2);font-size:14px">
        <li><code>stg_transactions.sql</code>ì— <code>ROW_NUMBER() PARTITION BY transaction_id</code> ì¶”ê°€</li>
        <li>Great Expectationsì— <code>expect_column_values_to_be_unique(transaction_id)</code> ê·œì¹™ ì¶”ê°€</li>
        <li>í´ë¼ì´ì–¸íŠ¸ SDKì— idempotency key ë„ì… ìš”ì²­</li>
      </ol>
    </div>
    <div class="lesson">ğŸ’¡ <strong>êµí›ˆ:</strong> ìˆ˜ì§‘ ë‹¨ê³„ì˜ ì¤‘ë³µì€ ë³€í™˜ ë‹¨ê³„ì—ì„œ ë°˜ë“œì‹œ ì œê±°í•´ì•¼ í•˜ë©°, ì´ë¥¼ ìë™ ê°ì§€í•˜ëŠ” í’ˆì§ˆ ê·œì¹™ì´ ì‚¬ì „ì— ì¡´ì¬í•´ì•¼ í•¨.</div>
  </div>

  <!-- Case 2 -->
  <div class="trouble-card">
    <h4><span class="tag tag-yellow" style="margin-right:8px">Case 2</span> íƒì†Œë…¸ë¯¸ ë¯¸ì¤€ìˆ˜ë¡œ í¼ë„ ë¶„ì„ ëˆ„ë½</h4>
    <div class="situation">
      <strong>ìƒí™©:</strong> ì‹ ê·œ ê¸°ëŠ¥ ë°°í¬ ì‹œ <code>paymentView</code> (camelCase)ë¡œ ì´ë²¤íŠ¸ë¥¼ ë³´ë‚´, ê²°ì œ í¼ë„ì˜ Step 1ì´ 30% ê¸‰ê°í•œ ê²ƒì²˜ëŸ¼ ë³´ì„.
    </div>
    <div class="solution">
      <strong>í•´ê²°:</strong>
      <ol style="margin:8px 0 0 20px;color:var(--text2);font-size:14px">
        <li><code>event_name</code> regex ê²€ì¦ì„ P0 ê·œì¹™ìœ¼ë¡œ ìŠ¹ê²©</li>
        <li>ê°œë°œì ê°€ì´ë“œì— "ê³µí†µ ì‹¤ìˆ˜ ëª©ë¡" ì¶”ê°€</li>
        <li>CI/CD íŒŒì´í”„ë¼ì¸ì— ìŠ¤í‚¤ë§ˆ ê²€ì¦ ë‹¨ê³„ ì¶”ê°€</li>
      </ol>
    </div>
    <div class="lesson">ğŸ’¡ <strong>êµí›ˆ:</strong> ë„¤ì´ë° ê·œì¹™ì€ ë¬¸ì„œë§Œìœ¼ë¡œëŠ” ê°•ì œí•  ìˆ˜ ì—†ë‹¤. ê²€ì¦ ìë™í™”ê°€ ë°˜ë“œì‹œ í•„ìš”.</div>
  </div>

  <!-- Case 3 -->
  <div class="trouble-card">
    <h4><span class="tag tag-yellow" style="margin-right:8px">Case 3</span> í™˜ë¶ˆ ë¯¸ë°˜ì˜ìœ¼ë¡œ ARPPU ê³¼ëŒ€ ì‚°ì¶œ</h4>
    <div class="situation">
      <strong>ìƒí™©:</strong> ARPPU ì‚°ì¶œ ì‹œ í™˜ë¶ˆ ê±´ì„ ì°¨ê°í•˜ì§€ ì•Šì•„ ì‹¤ì œë³´ë‹¤ 15% ë†’ê²Œ ì‚°ì¶œ.
    </div>
    <div class="solution">
      <strong>í•´ê²°:</strong>
      <ol style="margin:8px 0 0 20px;color:var(--text2);font-size:14px">
        <li><code>mart_revenue.sql</code>ì— refund LEFT JOIN ì¶”ê°€</li>
        <li><code>assert_arppu_reasonable</code> dbt í…ŒìŠ¤íŠ¸ë¡œ Z-score ì´ìƒì¹˜ ìë™ ê°ì§€</li>
      </ol>
    </div>
    <div class="lesson">ğŸ’¡ <strong>êµí›ˆ:</strong> ê¸ˆìœµ ì§€í‘œëŠ” "ë¹¼ì•¼ í•  ê²ƒ"ì„ ë†“ì¹˜ê¸° ì‰½ë‹¤. í†µê³„ì  ì´ìƒì¹˜ íƒì§€ê°€ ì•ˆì „ì¥ì¹˜ ì—­í• .</div>
  </div>
</section>



</main>
<!-- â•â•â•â•â•â•â•â•â•â•â• CHARTS â•â•â•â•â•â•â•â•â•â•â• -->
<script>
const B='#3B82F6',P='#8B5CF6',K='#EC4899',G='#22C55E',Y='#F59E0B',GY='#6B7280',GR='#3F3F46',TX='#A1A1AA';
Chart.defaults.color=TX;Chart.defaults.borderColor=GR;
Chart.defaults.font.family="'Inter',system-ui,sans-serif";
Chart.defaults.plugins.legend.labels.usePointStyle=true;
Chart.defaults.plugins.legend.labels.pointStyleWidth=8;
const d14=['12/02','12/03','12/04','12/05','12/06','12/07','12/08','12/09','12/10','12/11','12/12','12/13','12/14','12/15'];

// Revenue
new Chart(document.getElementById('revenueChart'),{type:'bar',data:{labels:d14,datasets:[
{label:'Net Revenue (ì–µì›)',data:[41.2,43.8,39.5,44.1,46.3,52.8,48.2,42.1,45.6,47.3,44.8,46.2,48.5,48.0],backgroundColor:B+'80',borderColor:B,borderWidth:1,borderRadius:4,order:2},
{label:'7ì¼ ì´ë™í‰ê· ',data:[null,null,null,null,null,null,45.1,45.3,45.5,46.1,46.7,46.4,46.2,46.1],type:'line',borderColor:Y,borderWidth:2,pointRadius:0,tension:.4,order:1}
]},options:{responsive:true,maintainAspectRatio:false,scales:{y:{beginAtZero:false,grid:{color:GR}},x:{grid:{display:false}}}}});

// DAU
new Chart(document.getElementById('dauChart'),{type:'line',data:{labels:d14,datasets:[
{label:'DAU (ë§Œëª…)',data:[112,118,115,121,119,132,128,114,120,122,118,121,124,124],borderColor:B,backgroundColor:B+'20',fill:true,tension:.4,pointRadius:3},
{label:'WAU (ë§Œëª…)',data:[380,385,388,392,396,405,412,408,401,398,402,406,410,412],borderColor:P,borderDash:[5,5],tension:.4,pointRadius:0},
{label:'MAU (ë§Œëª…)',data:[890,892,895,898,901,908,912,915,918,920,922,924,926,928],borderColor:GY,borderDash:[2,2],tension:.4,pointRadius:0}
]},options:{responsive:true,maintainAspectRatio:false,scales:{y:{grid:{color:GR}},x:{grid:{display:false}}}}});

// Retention
new Chart(document.getElementById('retentionChart'),{type:'line',data:{labels:['D0','D1','D3','D7','D14','D30'],datasets:[
{label:'Dec W2',data:[100,68,55,42.3,31.5,null],borderColor:B,backgroundColor:B+'20',fill:true,tension:.3,pointRadius:5,pointBackgroundColor:B},
{label:'Dec W1',data:[100,65,52,39.8,29.1,21.3],borderColor:P,borderDash:[5,5],tension:.3,pointRadius:4},
{label:'Nov W4',data:[100,63,50,38.2,27.6,19.8],borderColor:GY,borderDash:[2,2],tension:.3,pointRadius:3}
]},options:{responsive:true,maintainAspectRatio:false,scales:{y:{min:0,max:110,ticks:{callback:v=>v+'%'},grid:{color:GR}},x:{grid:{display:false}}}}});

// Payment Method
new Chart(document.getElementById('paymentChart'),{type:'doughnut',data:{labels:['QuickPay ì”ì•¡','ì‹ ìš©ì¹´ë“œ','ì²´í¬ì¹´ë“œ','ê³„ì¢Œì´ì²´','ê°€ìƒê³„ì¢Œ'],datasets:[{data:[42,28,15,10,5],backgroundColor:[B,P,K,G,GY],borderColor:'#18181B',borderWidth:3}]},options:{responsive:true,maintainAspectRatio:false,cutout:'60%',plugins:{legend:{position:'right',labels:{padding:16}}}}});

// Volume
const hrs=Array.from({length:24},(_,i)=>`${String(i).padStart(2,'0')}:00`);
const norm=[12,8,5,3,4,15,45,82,95,88,76,85,92,87,78,72,85,94,98,88,72,55,38,22];
const act=[11,7,5,3,4,14,43,80,93,86,74,83,90,85,76,70,83,92,96,86,70,53,36,21];
new Chart(document.getElementById('volumeChart'),{type:'line',data:{labels:hrs,datasets:[
{label:'ì‹¤ì œ ë³¼ë¥¨ (ë§Œê±´)',data:act,borderColor:B,fill:false,tension:.4,pointRadius:3,borderWidth:2},
{label:'ìƒí•œ',data:norm.map(v=>Math.round(v*1.3)),borderColor:G+'40',borderDash:[4,4],fill:false,tension:.4,pointRadius:0,borderWidth:1},
{label:'í•˜í•œ',data:norm.map(v=>Math.round(v*0.7)),borderColor:G+'40',borderDash:[4,4],fill:'-1',backgroundColor:G+'08',tension:.4,pointRadius:0,borderWidth:1}
]},options:{responsive:true,maintainAspectRatio:false,scales:{y:{beginAtZero:true,grid:{color:GR}},x:{grid:{display:false}}}}});

// Hide inactive chart tabs after Chart.js renders
document.querySelectorAll('.chart-tab-panel:not(.active)').forEach(p=>p.style.display='none');
document.querySelectorAll('.chart-tab').forEach(btn=>{
  btn.addEventListener('click',()=>{
    document.querySelectorAll('.chart-tab').forEach(b=>b.classList.remove('active'));
    document.querySelectorAll('.chart-tab-panel').forEach(p=>{p.classList.remove('active');p.style.display='none'});
    btn.classList.add('active');
    const el=document.getElementById(btn.dataset.tab);
    el.classList.add('active');
    el.style.display='block';
  });
});

// Highlight.js
hljs.highlightAll();

// Nav active state
const sections=document.querySelectorAll('section[id]');
const navLinks=document.querySelectorAll('.nav-links a');
window.addEventListener('scroll',()=>{
  let cur='';
  sections.forEach(s=>{if(scrollY>=s.offsetTop-120)cur=s.id});
  navLinks.forEach(a=>{a.classList.toggle('active',a.getAttribute('href')==='#'+cur)});
});
</script>
</body>
</html>
